"use strict";exports.id=950,exports.ids=[950],exports.modules={950:(t,a,e)=>{e.a(t,async(t,r)=>{try{e.d(a,{e:()=>handleFiatTransfer,n:()=>handleCryptoTransfer});var n=e(9437),s=e(5788),i=e(7931),o=t([n,s]);async function handleFiatTransfer(t,a,e,r,n){let o=await (0,i.Q7)(t);if(o<a)throw Error("Insufficient fiat balance");let c=await (0,s.gd)({amount:a,account_number:e,bank_code:r,narration:n});return await (0,i.QF)(t,"debit",a,c.id,{kind:"fiat_transfer"}),c}async function handleCryptoTransfer(t,a,e,r){let s=Number(e);if(s<=0)throw Error("Amount must be positive");let o="USDC",c=await (0,i.CW)(t,o);if(c<s)throw Error("Insufficient crypto balance");console.log(`Initiating crypto transfer: ${s} ${o} to ${a}`);let d=await (0,n.fM)({toAddress:a,amount:e,blockchain:r||"base",reference:`user-${t}-${Date.now()}`,metadata:{userId:t,symbol:o}});console.log(`Crypto transfer initiated: ${d.txId}, status: ${d.status}`);let f=Number(process.env.EXCHANGE_RATE_USDC_NGN||"1500"),l=s*f;return await (0,i.QF)(t,"debit",l,d.txId,{kind:"crypto_transfer",symbol:o,blockchain:r||"base",txHash:d.txHash,recipientAddress:a}),await (0,i.ag)(t,o,-s,-l),{txHash:d.txHash,txId:d.txId,status:d.status,fiatEquivalent:l}}[n,s]=o.then?(await o)():o,r()}catch(t){r(t)}})}};